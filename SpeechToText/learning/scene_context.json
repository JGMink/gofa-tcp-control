{
  "_meta": {
    "version": "3.0",
    "units": "meters for positions, cm for distances in motion_params, Unity/RobotStudio coordinate system",
    "notes": [
      "Positions are approximate — calibrate against real robot before first use.",
      "Tiles are 100x100x10mm rigid PLA/PETG props. All same size — gripper profiles are fixed constants.",
      "Assembly fixture has guide walls for passive alignment and bottom relief slots.",
      "Stack height increments by tile_height_cm (1.0cm) per layer.",
      "tcp_commands.json has two blocks: 'command' (Python writes) and 'state' (Unity/RobotStudio writes back after confirming execution). All LLM context reads from 'state', never from Python's in-memory tracking.",
      "Multiple assembly stacks are supported. Each named stack zone has its own assembly_stack list and stack_height. Currently only assembly_fixture is active, but additional zones can be added to locations and state.stacks."
    ]
  },

  "scene": {
    "name": "sandwich_assembly",
    "description": "Ingredient tray zone + one or more assembly fixture zones. Serving plates to be introduced later."
  },

  "items": {
    "bread": {
      "description": "Bread tile (100x100x10mm PLA prop) — represents any starch or base: bun, roll, toast, sourdough, pita, wrap, cracker, waffle, english muffin",
      "slot_location": "bread_slot",
      "properties": {
        "stackable": true,
        "fragile": false,
        "tile_height_cm": 1.0
      }
    },
    "cheese": {
      "description": "Cheese tile (100x100x10mm PLA prop) — represents any dairy or soft layer: cheddar, swiss, brie, mozzarella, cream cheese, hummus, sauce, spread",
      "slot_location": "cheese_slot",
      "properties": {
        "stackable": true,
        "fragile": false,
        "tile_height_cm": 1.0
      }
    },
    "lettuce": {
      "description": "Lettuce tile (100x100x10mm PLA prop) — represents any leafy green or vegetable layer: spinach, arugula, kale, greens, cabbage, microgreens, basil",
      "slot_location": "lettuce_slot",
      "properties": {
        "stackable": true,
        "fragile": true,
        "tile_height_cm": 1.0
      }
    },
    "tomato": {
      "description": "Tomato tile (100x100x10mm PLA prop) — represents any juicy or acidic topping: roma, beefsteak, roasted pepper, pickle, onion, cucumber, avocado",
      "slot_location": "tomato_slot",
      "properties": {
        "stackable": true,
        "fragile": true,
        "tile_height_cm": 1.0
      }
    },
    "meat": {
      "description": "Protein/meat tile (100x100x10mm PLA prop) — represents any protein layer: bacon, patty, burger, ham, turkey, chicken, tuna, tofu, falafel, beef",
      "slot_location": "meat_slot",
      "properties": {
        "stackable": true,
        "fragile": false,
        "tile_height_cm": 1.0
      }
    }
  },

  "locations": {
    "home": {
      "description": "Robot home/starting position. Safe resting state.",
      "position": {"x": 0.0, "y": 0.567, "z": -0.24},
      "type": "waypoint",
      "zone": null
    },

    "bread_slot": {
      "description": "Bread tile slot in the ingredient tray",
      "position": {"x": -0.2, "y": 0.3, "z": 0.1},
      "type": "ingredient_slot",
      "zone": "ingredient",
      "item": "bread"
    },
    "cheese_slot": {
      "description": "Cheese tile slot in the ingredient tray",
      "position": {"x": -0.1, "y": 0.3, "z": 0.1},
      "type": "ingredient_slot",
      "zone": "ingredient",
      "item": "cheese"
    },
    "lettuce_slot": {
      "description": "Lettuce tile slot in the ingredient tray",
      "position": {"x": 0.0, "y": 0.3, "z": 0.1},
      "type": "ingredient_slot",
      "zone": "ingredient",
      "item": "lettuce"
    },
    "tomato_slot": {
      "description": "Tomato tile slot in the ingredient tray",
      "position": {"x": 0.1, "y": 0.3, "z": 0.1},
      "type": "ingredient_slot",
      "zone": "ingredient",
      "item": "tomato"
    },
    "meat_slot": {
      "description": "Meat/protein tile slot in the ingredient tray",
      "position": {"x": 0.2, "y": 0.3, "z": 0.1},
      "type": "ingredient_slot",
      "zone": "ingredient",
      "item": "meat"
    },

    "assembly_fixture": {
      "description": "Primary/default assembly zone. Passive alignment fixture — guide walls correct minor misalignment. Bottom relief slots allow gripper clearance. Drop height computed from stack_height at runtime. Also aliased as assembly_center.",
      "position": {"x": 0.0, "y": 0.3, "z": 0.0},
      "type": "assembly",
      "zone": "assembly",
      "stack_key": "assembly_fixture",
      "spatial_alias": "center"
    },

    "assembly_left": {
      "description": "Left assembly zone. Same fixture type as assembly_fixture, offset to the left. Use when user says 'left', 'over there', or when assembly_fixture is occupied.",
      "position": {"x": -0.15, "y": 0.3, "z": 0.0},
      "type": "assembly",
      "zone": "assembly",
      "stack_key": "assembly_left",
      "spatial_alias": "left"
    },

    "assembly_right": {
      "description": "Right assembly zone. Same fixture type as assembly_fixture, offset to the right. Use when user says 'right' or when both assembly_fixture and assembly_left are occupied.",
      "position": {"x": 0.15, "y": 0.3, "z": 0.0},
      "type": "assembly",
      "zone": "assembly",
      "stack_key": "assembly_right",
      "spatial_alias": "right"
    },

    "_comment_plates": "Serving plates to be added here when introduced. Each will have type: serving_plate and a corresponding entry in state.plates."
  },

  "gripper_profiles": {
    "_note": "All tiles are the same size (100x100x10mm). Profiles are fixed constants — change here and they propagate everywhere. Executor resolves profile name to position_m before sending to Unity/RobotStudio.",
    "open": {
      "position_m": 0.11,
      "description": "Fully open. Used for safe arm travel between locations."
    },
    "close_object": {
      "position_m": 0.02,
      "description": "Closed on standard tile. Firm grip for lifting."
    },
    "full_close": {
      "position_m": 0.0,
      "description": "Fully closed. Reserved for calibration only — not used in normal operation."
    }
  },

  "motion_params": {
    "_note": "All distance defaults in cm. Used by executor when no override is specified. LLM-generated sequences may suggest per-sequence speed overrides via adjust_speed — these override the persistent state for that sequence only if explicitly reset afterward.",
    "defaults": {
      "lift_clearance_cm": 5.0,
      "drop_approach_cm": 3.0,
      "min_lower_cm": 0.5,
      "move_distance_cm": 1.0,
      "tile_height_cm": 1.0
    },
    "speed_profiles": {
      "slow":   {"multiplier": 0.5,  "aliases": ["slow", "slower", "careful", "gentle", "easy", "nice and neat", "neat"]},
      "normal": {"multiplier": 1.0,  "aliases": ["normal", "regular", "default", "medium"]},
      "fast":   {"multiplier": 1.5,  "aliases": ["fast", "faster", "quick", "hurry", "speed up", "quickly"]}
    },
    "distance_aliases": {
      "_note": "Natural language distance words resolved before passing to move_relative. LLM may output these words or numeric values — executor normalizes both.",
      "tiny":    0.3,
      "teensy":  0.3,
      "small":   0.5,
      "a bit":   0.5,
      "a tad":   0.5,
      "default": 1.0,
      "large":   2.0,
      "big":     2.0,
      "a lot":   2.0,
      "far":     2.0
    }
  },

  "state": {
    "_note": "Live runtime state. Updated by executor after each instruction. Read by LLM context builder before each sequence interpretation. tcp_commands.json 'state' block is the ground truth for position and gripper — this file is the ground truth for assembly and speed.",
    "gripper": "open",
    "holding": null,
    "speed": "normal",
    "current_position": "home",
    "active_zone": "assembly_fixture",
    "stacks": {
      "_note": "Each key is a named assembly zone (matching a location with type: assembly). Items listed bottom-to-top. All zones start empty.",
      "assembly_fixture": {
        "items": [],
        "height": 0
      },
      "assembly_left": {
        "items": [],
        "height": 0
      },
      "assembly_right": {
        "items": [],
        "height": 0
      }
    },
    "plates": {
      "_note": "Populated when plates are introduced. Each key is a plate location name, value is the stack delivered to it."
    }
  },

  "recipes": {
    "_note": "Known sandwich recipes. Used by LLM to interpret named sandwich commands. The LLM generates add_layer sequences from these — it does not call a 'make_recipe' primitive.",
    "classic": {
      "description": "Classic sandwich",
      "layers": ["bread", "meat", "lettuce", "tomato", "bread"],
      "aliases": ["classic", "classic sandwich", "regular", "standard", "normal sandwich"]
    },
    "blt": {
      "description": "BLT — bacon, lettuce, tomato. Uses meat tile as bacon substitute.",
      "layers": ["bread", "meat", "lettuce", "tomato", "bread"],
      "aliases": ["blt", "BLT", "bacon lettuce tomato"]
    },
    "cheese": {
      "description": "Simple cheese sandwich",
      "layers": ["bread", "cheese", "bread"],
      "aliases": ["cheese sandwich", "grilled cheese", "cheese only", "just cheese"]
    },
    "veggie": {
      "description": "Vegetarian sandwich",
      "layers": ["bread", "lettuce", "tomato", "cheese", "bread"],
      "aliases": ["veggie", "vegetarian", "veggie sandwich", "garden sandwich"]
    },
    "club": {
      "description": "Club sandwich with everything",
      "layers": ["bread", "meat", "cheese", "lettuce", "tomato", "bread"],
      "aliases": ["club", "club sandwich", "the works", "everything", "loaded"]
    }
  },

  "modifiers": {
    "_note": "Recipe modifier words. LLM interprets these to modify a base recipe's layer list before generating the add_layer sequence.",
    "double": {
      "description": "Add the specified ingredient twice instead of once",
      "examples": ["double lettuce", "double cheese", "double meat"],
      "action": "duplicate_layer"
    },
    "extra": {
      "description": "Same as double",
      "examples": ["extra lettuce", "extra cheese"],
      "action": "duplicate_layer"
    },
    "no": {
      "description": "Remove the specified ingredient",
      "examples": ["no tomato", "without cheese"],
      "action": "remove_layer"
    },
    "hold": {
      "description": "Same as no",
      "examples": ["hold the tomato", "hold the lettuce"],
      "action": "remove_layer"
    },
    "swap": {
      "description": "Replace one ingredient with another",
      "examples": ["swap cheese for meat", "replace tomato with lettuce"],
      "action": "replace_layer"
    }
  },

  "constraints": {
    "_note": "Hard limits enforced by the executor's rule layer. RobotStudio/RAPID enforces joint and TCP limits at the hardware level — these are the Python-side pre-checks.",
    "max_stack_height": 8,
    "max_tiles_per_ingredient": 5,
    "workspace_bounds": {
      "_note": "Soft TCP bounds in meters. Move commands that would exceed these are clamped. RobotStudio enforces the real envelope.",
      "x_min": -0.3, "x_max": 0.3,
      "y_min": 0.2,  "y_max": 0.7,
      "z_min": -0.3, "z_max": 0.2
    }
  },

  "tcp_schema": {
    "_note": "Describes the structure of tcp_commands.json. Python writes to 'command'. Unity/RobotStudio writes confirmed state back to 'state'. LLM context always reads from 'state'.",
    "command": {
      "x": "float — target TCP x position in meters",
      "y": "float — target TCP y position in meters",
      "z": "float — target TCP z position in meters",
      "gripper_position": "float — gripper gap in meters (from gripper_profiles)",
      "speed_multiplier": "float — current speed multiplier (from motion_params.speed_profiles)",
      "emergency_halt": "bool — if true, robot stops immediately"
    },
    "state": {
      "x": "float — confirmed TCP x after last move",
      "y": "float — confirmed TCP y after last move",
      "z": "float — confirmed TCP z after last move",
      "gripper_position": "float — confirmed gripper position",
      "speed_multiplier": "float — confirmed speed multiplier",
      "confirmed_at": "ISO8601 timestamp of last confirmed state from Unity/RobotStudio"
    }
  }
}
